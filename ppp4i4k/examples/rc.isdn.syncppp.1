#!/bin/sh
#
# BE SURE TO EDIT THIS FILE BEFORE USING IT !!!!!
# this is an example script to use with isdn4linux
# compiled into kernel
#
# don't forget to edit the files
#     /etc/ppp/pap-secrets or 
#     /etc/ppp/chap-secrets 
#

LOCAL_NUMBER="987654"
REMOTE_NUMBER="5678"		
LOCAL_IP="172.16.3.43" 
REMOTE_IP="172.16.0.20"
DEVICE="ippp0"

SYSPATH="/sbin"
TELESCTRL="$SYSPATH/telesctrl"
ISDNCTRL="$SYSPATH/isdnctrl"

# $TELESCTRL MyTeles 1 4      # enable verbose '4' mode

$ISDNCTRL addif  $DEVICE            # Create new interface 'DEVICE'
# $ISDNCTRL addphone $DEVICE in $REMOTE_NUMBER  # Set incoming phone-number
$ISDNCTRL addphone $DEVICE out $REMOTE_NUMBER   # Set outgoung phone-number
$ISDNCTRL eaz $DEVICE $LOCAL_NUMBER             # Set local EAZ .. 
$ISDNCTRL l2_prot $DEVICE hdlc      # for sync PPP: set Level 2 to HDLC
$ISDNCTRL l3_prot $DEVICE trans     # not really necessary, 'trans' is default
$ISDNCTRL encap $DEVICE syncppp     # encap the IP Pakets in PPP frames
$ISDNCTRL huptimeout $DEVICE 600    # Hangup-Timeout is 600 sec.
$ISDNCTRL chargehup $DEVICE off     # Hangup before next Charge-Info
$ISDNCTRL secure $DEVICE on         # Accept only configured phone-number

$SYSPATH/ifconfig $DEVICE $LOCAL_IP pointopoint $REMOTE_IP metric 1 -arp
$SYSPATH/route add default dev $DEVICE

# start the (new) deamon:
# -----------------------
# 'user myusername' : set username to get the right password from the
#    pap-secrets file(s)
# ipcp-accept-local ipcp-accept-remote : accept every IP address
# -vjccomp -ac -pc  : _my_ remote side doesn't support this, so disable it
# -bsdcomp : i4l-syncPPP driver doesn't support bsd-compression
# debug    :  enable debugging, WARNING: ipppd will also log your password 
# useifip  : get IP address information form the network interface
# /dev/ippp0 /dev/ippp1 /dev/ippp2 : connect to 3 devices for max.
#     three connections at the same time

$SYSPATH/ipppd user myusername  \
        ipcp-accept-local ipcp-accept-remote \
        -vjccomp -ac -pc \
        -detach \
        mru 1524 \
        -bsdcomp \
        debug \
        useifip \
        /dev/ippp0 /dev/ippp1 /dev/ippp2 &


